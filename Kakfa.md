# Kakfa

## AKF划分

![image-20210322104754340](Kakfa.assets/image-20210322104754340.png)



![image-20210322104704038](Kakfa.assets/image-20210322104704038.png)

![image-20210322105827421](Kakfa.assets/image-20210322105827421.png)

x轴：解决单点问题，高可用

y轴：解决业务划分，不同服务之间发送的消息按业务划分，业务隔离性比较好，解耦每个业务只关注自己的节点。（日志、数据库binlog）在Kafka中是不同的topic

z轴：解决分片分治（同一业务数据的拆分，在kafka中叫不同的partition），比如按业务拆分时binlog文件很大，讲binlog继续拆分，数据分片，细分的时候可以使用的手段有regin、随机哈希、映射

---

数据分区带了一致性问题，无关的数据分散到不同的分区中，以追求并发并行；有关的数据，一定要按原有的顺序发送到同一个分区里。（分区内部有序，分区外部无序）

![image-20210322112845961](Kakfa.assets/image-20210322112845961.png)

因为有offset偏移量能够保证，记录消费者读取到哪

topic是逻辑概念，partition是topic的子域，有物理实现 partition-0、partition-1，每个分区（会持久化到磁盘）做副本x轴，在x轴可以做读写分离，但是会有一致性的问题，kafka只能在主片上进行读写，什么时候挂了什么时候启用副本。

## 拓扑图

